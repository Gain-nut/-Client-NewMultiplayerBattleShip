{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asus\\\\battleship-client\\\\src\\\\components\\\\Game.js\",\n  _s = $RefreshSig$();\n// // src/components/Game.js\n// import React, { useState } from 'react';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import './Game.css';\n\n// function Game({ gameState, nickname }) {\n//   // State ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ß‡∏≤‡∏á (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Client ‡∏ô‡∏µ‡πâ)\n//   const [myShips, setMyShips] = useState([]);\n//   const totalShipParts = 16; // 4 ‡∏•‡∏≥ * 4 ‡∏ä‡πà‡∏≠‡∏á = 16 ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô\n\n//   // --- 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ---\n//   if (!gameState || !gameState.players) {\n//     return <div>Loading game...</div>;\n//   }\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   const opponentId = playerIds.find(id => id !== myPlayerId);\n\n//   const me = gameState.players[myPlayerId];\n//   const opponent = opponentId ? gameState.players[opponentId] : null;\n\n//   if (!me) return <div>Initializing...</div>;\n\n//   const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//   // --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Event ---\n//   const handlePlacementClick = (row, col) => {\n//     if (myShips.length < totalShipParts) {\n//       const newPart = { row, col };\n//       if (!myShips.some(part => part.row === row && part.col === col)) {\n//         setMyShips([...myShips, newPart]);\n//       }\n//     }\n//   };\n\n//   const handleConfirmPlacement = () => {\n//     if (myShips.length === totalShipParts) {\n//       socket.emit('place-ships', myShips);\n//     } else {\n//       alert(`Please place all ${totalShipParts} ship parts.`);\n//     }\n//   };\n\n//   const handleFire = (row, col) => {\n//     if (isMyTurn && gameState.gameStatus === 'playing') {\n//       socket.emit('fire-shot', { row, col });\n//     }\n//   };\n\n//   // --- 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Board ---\n//   const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//   // ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å\n//   if (gameState.gameStatus === 'placing') {\n//     myShips.forEach(part => { myDisplayBoard[part.row][part.col] = 'ship'; });\n//   } \n//   // ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á + ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π\n//   else {\n//     me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\n//     me.gameBoard.forEach((row, r_idx) => {\n//       row.forEach((cell, c_idx) => {\n//         if (cell === 'hit' || cell === 'miss') {\n//           myDisplayBoard[r_idx][c_idx] = cell;\n//         }\n//       });\n//     });\n//   }\n\n//   // --- 4. Render Component ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏° ---\n//   return (\n//     <div className=\"game-container\">\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Placing) ===== */}\n//       {gameState.gameStatus === 'placing' && (\n//         <div>\n//           {me.ships.length === 0 ? (\n//             <>\n//               <h3>Place Your Ships ({myShips.length} / {totalShipParts} parts)</h3>\n//               <GameBoard board={myDisplayBoard} onCellClick={handlePlacementClick} />\n//               <button onClick={handleConfirmPlacement} disabled={myShips.length !== totalShipParts}>\n//                 Confirm Placement\n//               </button>\n//             </>\n//           ) : (\n//             <h2>Waiting for {opponent?.nickname || 'opponent'} to place ships...</h2>\n//           )}\n//         </div>\n//       )}\n\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô (Playing) ===== */}\n//       {gameState.gameStatus === 'playing' && (\n//         <>\n//           <div className=\"turn-indicator\">\n//             <h2 className={isMyTurn ? 'my-turn' : ''}>\n//               {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\n//             </h2>\n//           </div>\n//           <div className=\"boards-container\">\n//             <div className=\"board-area\">\n//               <h3>Your Board (Score: {me.score})</h3>\n//               <GameBoard board={myDisplayBoard} onCellClick={() => {}} />\n//             </div>\n//             <div className=\"board-area\">\n//               <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\n//               {opponent ? (\n//                 <GameBoard board={opponent.gameBoard} onCellClick={handleFire} />\n//               ) : (\n//                 <p>Waiting for opponent...</p>\n//               )}\n//             </div>\n//           </div>\n//         </>\n//       )}\n\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß (Game Over) ===== */}\n//       {gameState.gameStatus === 'gameover' && (\n//         <div className=\"game-over\">\n//           <h1>Game Over!</h1>\n//           <h2>Winner is: {gameState.players[gameState.winner]?.nickname || 'Someone'}</h2>\n//         </div>\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n\n// // src/components/Game.js\n// import React, { useState } from 'react';\n// import { useDrop } from 'react-dnd';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import DraggableShip, { ItemTypes } from './DraggableShip';\n// import './Game.css';\n\n// // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô\n// const initialShips = [\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// ];\n\n// function Game({ gameState, nickname }) {\n//   const [myShips, setMyShips] = useState(initialShips);\n//   const [shipOrientation, setShipOrientation] = useState('horizontal');\n\n//   // --- Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Drop) ---\n//   const moveShip = (shipId, newPosition) => {\n//     setMyShips((prevShips) =>\n//       prevShips.map((ship) =>\n//         ship.id === shipId\n//           ? { ...ship, position: newPosition, orientation: shipOrientation }\n//           : ship\n//       )\n//     );\n//   };\n\n//   const [, drop] = useDrop(() => ({\n//     accept: ItemTypes.SHIP,\n//     drop: (item, monitor) => {\n//       // Logic ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏ô GameBoard ‡πÅ‡∏ó‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô\n//     },\n//   }));\n\n//   // --- Logic ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ---\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   if (!myPlayerId) return <div>Initializing...</div>;\n\n//   const me = gameState.players[myPlayerId];\n//   const opponentId = playerIds.find(id => id !== myPlayerId);\n//   const opponent = opponentId ? gameState.players[opponentId] : null;\n\n//   const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//   // --- ‡∏™‡∏£‡πâ‡∏≤‡∏á Array ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ Server ---\n//   const handleConfirmPlacement = () => {\n//     const allShipParts = [];\n//     myShips.forEach(ship => {\n//       if (ship.position) {\n//         for (let i = 0; i < ship.length; i++) {\n//           const part = {\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\n//           };\n//           allShipParts.push(part);\n//         }\n//       }\n//     });\n\n//     if (allShipParts.length === 16) {\n//         socket.emit('place-ships', allShipParts);\n//     } else {\n//         alert('Please place all 4 ships on the board.');\n//     }\n//   };\n\n//   const handleFire = (row, col) => {\n//     if (isMyTurn && gameState.gameStatus === 'playing') {\n//       socket.emit('fire-shot', { row, col });\n//     }\n//   };\n\n//   // --- ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Board ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---\n//   const placementBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//   myShips.forEach(ship => {\n//     if (ship.position) {\n//       for (let i = 0; i < ship.length; i++) {\n//         const row = ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i;\n//         const col = ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col;\n//         if (row < 8 && col < 8) {\n//           placementBoard[row][col] = 'ship';\n//         }\n//       }\n//     }\n//   });\n\n//   // -- ‡∏™‡πà‡∏ß‡∏ô Render --\n//   return (\n//     <div className=\"game-container\" ref={drop}>\n//       {gameState.gameStatus === 'placing' && (\n//         <div className=\"placement-container\">\n//           {me.ships.length === 0 ? (\n//             <>\n//               <h3>Place Your Fleet</h3>\n//               <GameBoard board={placementBoard} onDropShip={moveShip} />\n//               <div className=\"ship-palette\">\n//                 <div className=\"ships-to-drag\">\n//                     {myShips.filter(s => s.position === null).map(s => <DraggableShip key={s.id} ship={s} />)}\n//                 </div>\n//                 <button onClick={() => setShipOrientation(o => o === 'horizontal' ? 'vertical' : 'horizontal')}>\n//                   Rotate (Now: {shipOrientation})\n//                 </button>\n//               </div>\n//               <button onClick={handleConfirmPlacement}>Confirm Placement</button>\n//             </>\n//           ) : (\n//             <h2>Waiting for opponent...</h2>\n//           )}\n//         </div>\n//       )}\n\n//       {/* --- ‡∏™‡πà‡∏ß‡∏ô Playing ‡πÅ‡∏•‡∏∞ Game Over (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) --- */}\n//       {gameState.gameStatus === 'playing' && (\n//         <>\n//             {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Playing ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ... */}\n//         </>\n//       )}\n//       {gameState.gameStatus === 'gameover' && (\n//         <>\n//             {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Game Over ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ... */}\n//         </>\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n\n// //v \n// // src/components/Game.js\n// import React, { useState } from 'react';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import DraggableShip from './DraggableShip';\n// import './Game.css';\n\n// // Initial state for the four ships\n// const initialShips = [\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// ];\n\n// function Game({ gameState, nickname }) {\n//   const [myShips, setMyShips] = useState(initialShips);\n\n//   // --- 1. CORE VALIDATION LOGIC ---\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\n//     const { length, orientation } = shipToPlace;\n//     const { row, col } = newPosition;\n\n//     // Boundary Check: Ensure the ship does not go off the board\n//     if (orientation === 'horizontal') {\n//       if (col < 0 || col + length > 8) return false;\n//     } else { // vertical\n//       if (row < 0 || row + length > 8) return false;\n//     }\n\n//     // Collision Check: Ensure the ship does not overlap with others\n//     const newParts = Array.from({ length }).map((_, i) => ({\n//       row: orientation === 'horizontal' ? row : row + i,\n//       col: orientation === 'horizontal' ? col + i : col,\n//     }));\n\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\n//     for (const otherShip of otherShips) {\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\n//       }));\n\n//       for (const newPart of newParts) {\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\n//           return false; // Collision detected\n//         }\n//       }\n//     }\n//     return true; // Placement is valid\n//   };\n\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\n//   const handleShipDrop = (ship, newPosition) => {\n//     if (canPlaceShip(ship, newPosition, myShips)) {\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\n//     } else {\n//       console.log(\"Invalid placement.\");\n//     }\n//   };\n\n//   const handleRotatePaletteShip = (shipId) => {\n//     setMyShips(ships => ships.map(s => \n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\n//     ));\n//   };\n\n//   const handleConfirmPlacement = () => {\n//     const placedShips = myShips.filter(s => s.position);\n//     if (placedShips.length !== 4) {\n//       alert('Please place all 4 ships on the board.');\n//       return;\n//     }\n//     const allShipParts = [];\n//     placedShips.forEach(ship => {\n//         for (let i = 0; i < ship.length; i++) {\n//             allShipParts.push({\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\n//             });\n//         }\n//     });\n//     socket.emit('place-ships', allShipParts);\n//   };\n\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   if (!myPlayerId) return <div>Initializing...</div>;\n\n//   const me = gameState.players[myPlayerId];\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\n//   const shipsInPalette = myShips.filter(s => s.position === null);\n\n//   // This part is for rendering the full game after placement is done\n//   // It is simplified here to avoid mixing code from different stages\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\n//       me.gameBoard.forEach((row, r_idx) => {\n//           row.forEach((cell, c_idx) => {\n//           if (cell === 'hit' || cell === 'miss') {\n//               myDisplayBoard[r_idx][c_idx] = cell;\n//           }\n//           });\n//       });\n\n//       const handleFire = (row, col) => {\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\n//               socket.emit('fire-shot', { row, col });\n//           }\n//       };\n\n//       return (\n//         <div className=\"game-container\">\n//             {gameState.gameStatus === 'playing' && (\n//                 <>\n//                   <div className=\"turn-indicator\">\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\n//                     </h2>\n//                   </div>\n//                   <div className=\"boards-container\">\n//                     <div className=\"board-area\">\n//                       <h3>Your Board (Score: {me.score})</h3>\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\n//                     </div>\n//                     <div className=\"board-area\">\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\n//                     </div>\n//                   </div>\n//                 </>\n//             )}\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\n//         </div>\n//       );\n//   }\n\n//   // This is the renderer for the ship placement phase\n//   return (\n//     <div className=\"game-container\">\n//       {me.ships.length === 0 ? (\n//         <div className=\"placement-container\">\n//           <h3>Place Your Fleet</h3>\n//           <p>Click ships in the palette to rotate them.</p>\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\n//           <div className=\"ship-palette\">\n//             {shipsInPalette.length > 0 ? (\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\n//             ) : (\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\n//             )}\n//           </div>\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\n//         </div>\n//       ) : (\n//           <h2>Waiting for opponent to place ships...</h2>\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n\n//v55\n// src/components/Game.js\n// //v \n// // src/components/Game.js\n// import React, { useState } from 'react';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import DraggableShip from './DraggableShip';\n// import './Game.css';\n\n// // Initial state for the four ships\n// const initialShips = [\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// ];\n\n// function Game({ gameState, nickname }) {\n//   const [myShips, setMyShips] = useState(initialShips);\n\n//   // --- 1. CORE VALIDATION LOGIC ---\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\n//     const { length, orientation } = shipToPlace;\n//     const { row, col } = newPosition;\n\n//     // Boundary Check: Ensure the ship does not go off the board\n//     if (orientation === 'horizontal') {\n//       if (col < 0 || col + length > 8) return false;\n//     } else { // vertical\n//       if (row < 0 || row + length > 8) return false;\n//     }\n\n//     // Collision Check: Ensure the ship does not overlap with others\n//     const newParts = Array.from({ length }).map((_, i) => ({\n//       row: orientation === 'horizontal' ? row : row + i,\n//       col: orientation === 'horizontal' ? col + i : col,\n//     }));\n\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\n//     for (const otherShip of otherShips) {\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\n//       }));\n\n//       for (const newPart of newParts) {\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\n//           return false; // Collision detected\n//         }\n//       }\n//     }\n//     return true; // Placement is valid\n//   };\n\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\n//   const handleShipDrop = (ship, newPosition) => {\n//     if (canPlaceShip(ship, newPosition, myShips)) {\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\n//     } else {\n//       console.log(\"Invalid placement.\");\n//     }\n//   };\n\n//   const handleRotatePaletteShip = (shipId) => {\n//     setMyShips(ships => ships.map(s => \n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\n//     ));\n//   };\n\n//   const handleConfirmPlacement = () => {\n//     const placedShips = myShips.filter(s => s.position);\n//     if (placedShips.length !== 4) {\n//       alert('Please place all 4 ships on the board.');\n//       return;\n//     }\n//     const allShipParts = [];\n//     placedShips.forEach(ship => {\n//         for (let i = 0; i < ship.length; i++) {\n//             allShipParts.push({\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\n//             });\n//         }\n//     });\n//     socket.emit('place-ships', allShipParts);\n//   };\n\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   if (!myPlayerId) return <div>Initializing...</div>;\n\n//   const me = gameState.players[myPlayerId];\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\n//   const shipsInPalette = myShips.filter(s => s.position === null);\n\n//   // This part is for rendering the full game after placement is done\n//   // It is simplified here to avoid mixing code from different stages\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\n//       me.gameBoard.forEach((row, r_idx) => {\n//           row.forEach((cell, c_idx) => {\n//           if (cell === 'hit' || cell === 'miss') {\n//               myDisplayBoard[r_idx][c_idx] = cell;\n//           }\n//           });\n//       });\n\n//       const handleFire = (row, col) => {\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\n//               socket.emit('fire-shot', { row, col });\n//           }\n//       };\n\n//       return (\n//         <div className=\"game-container\">\n//             {gameState.gameStatus === 'playing' && (\n//                 <>\n//                   <div className=\"turn-indicator\">\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\n//                     </h2>\n//                   </div>\n//                   <div className=\"boards-container\">\n//                     <div className=\"board-area\">\n//                       <h3>Your Board (Score: {me.score})</h3>\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\n//                     </div>\n//                     <div className=\"board-area\">\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\n//                     </div>\n//                   </div>\n//                 </>\n//             )}\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\n//         </div>\n//       );\n//   }\n\n//   // This is the renderer for the ship placement phase\n//   return (\n//     <div className=\"game-container\">\n//       {me.ships.length === 0 ? (\n//         <div className=\"placement-container\">\n//           <h3>Place Your Fleet</h3>\n//           <p>Click ships in the palette to rotate them.</p>\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\n//           <div className=\"ship-palette\">\n//             {shipsInPalette.length > 0 ? (\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\n//             ) : (\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\n//             )}\n//           </div>\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\n//         </div>\n//       ) : (\n//           <h2>Waiting for opponent to place ships...</h2>\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n\n///////------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n// import React, { useState } from 'react'; \n// import { useDrop } from 'react-dnd';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import DraggableShip from './DraggableShip';\n// import './Game.css';\n\n// // Initial state for the four ships\n// const initialShips = [\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// ];\n\n// function Game({ gameState, nickname }) {\n//   // const [myShips, setMyShips] = useState(initialShips);\n//   const [myShips, setMyShips] = useState([]);\n\n//   // Reset ships state when starting a new placement phase\n//   useEffect(() => {\n//     if (gameState?.gameStatus === 'placing' && myShips.length === 0) {\n//       setMyShips(initialShips);\n//     }\n//   }, [gameState?.gameStatus, myShips.length]);\n\n//   // --- 1. CORE VALIDATION LOGIC ---\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\n//     const { length, orientation } = shipToPlace;\n//     const { row, col } = newPosition;\n\n//     // Boundary Check: Ensure the ship does not go off the board\n//     if (orientation === 'horizontal') {\n//       if (col < 0 || col + length > 8) return false;\n//     } else { // vertical\n//       if (row < 0 || row + length > 8) return false;\n//     }\n\n//     // Collision Check: Ensure the ship does not overlap with others\n//     const newParts = Array.from({ length }).map((_, i) => ({\n//       row: orientation === 'horizontal' ? row : row + i,\n//       col: orientation === 'horizontal' ? col + i : col,\n//     }));\n\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\n//     for (const otherShip of otherShips) {\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\n//       }));\n\n//       for (const newPart of newParts) {\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\n//           return false; // Collision detected\n//         }\n//       }\n//     }\n//     return true; // Placement is valid\n//   };\n\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\n//   const handleShipDrop = (ship, newPosition) => {\n//     if (canPlaceShip(ship, newPosition, myShips)) {\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\n//     } else {\n//       console.log(\"Invalid placement.\");\n//     }\n//   };\n\n//   const handleRotatePaletteShip = (shipId) => {\n//     setMyShips(ships => ships.map(s => \n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\n//     ));\n//   };\n\n//   const handleConfirmPlacement = () => {\n//     const placedShips = myShips.filter(s => s.position);\n//     if (placedShips.length !== 4) {\n//       alert('Please place all 4 ships on the board.');\n//       return;\n//     }\n//     const allShipParts = [];\n//     placedShips.forEach(ship => {\n//         for (let i = 0; i < ship.length; i++) {\n//             allShipParts.push({\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\n//             });\n//         }\n//     });\n//     socket.emit('place-ships', allShipParts);\n//   };\n\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   if (!myPlayerId) return <div>Initializing...</div>;\n\n//   const me = gameState.players[myPlayerId];\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\n//   const shipsInPalette = myShips.filter(s => s.position === null);\n\n//   // This part is for rendering the full game after placement is done\n//   // It is simplified here to avoid mixing code from different stages\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\n//       me.gameBoard.forEach((row, r_idx) => {\n//           row.forEach((cell, c_idx) => {\n//           if (cell === 'hit' || cell === 'miss') {\n//               myDisplayBoard[r_idx][c_idx] = cell;\n//           }\n//           });\n//       });\n\n//       const handleFire = (row, col) => {\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\n//               socket.emit('fire-shot', { row, col });\n//           }\n//       };\n\n//       return (\n//         <div className=\"game-container\">\n//             {gameState.gameStatus === 'playing' && (\n//                 <>\n//                   <div className=\"turn-indicator\">\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\n//                     </h2>\n//                   </div>\n//                   <div className=\"boards-container\">\n//                     <div className=\"board-area\">\n//                       <h3>Your Board (Score: {me.score})</h3>\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\n//                     </div>\n//                     <div className=\"board-area\">\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\n//                     </div>\n//                   </div>\n//                 </>\n//             )}\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\n//         </div>\n//       );\n//   }\n\n//   // This is the renderer for the ship placement phase\n//   return (\n//     <div className=\"game-container\">\n//       {me.ships.length === 0 ? (\n//         <div className=\"placement-container\">\n//           <h3>Place Your Fleet</h3>\n//           <p>Click ships in the palette to rotate them.</p>\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\n//           <div className=\"ship-palette\">\n//             {shipsInPalette.length > 0 ? (\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\n//             ) : (\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\n//             )}\n//           </div>\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\n//         </div>\n//       ) : (\n//           <h2>Waiting for opponent to place ships...</h2>\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n// //-------------------------------------------------------------------------------------------------------------------------------\n// // import React, { useState, useEffect } from 'react';\n// // import { useDrop } from 'react-dnd'; // <-- ‡πÄ‡∏û‡∏¥‡πà‡∏° useDrop ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà\n// // import { socket } from '../socket';\n// // import GameBoard from './GameBoard';\n// // import DraggableShip, { ItemTypes } from './DraggableShip';\n// // import './Game.css';\n\n// // const initialShips = [\n// //   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n// //   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n// //   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n// //   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// // ];\n\n// function Game({ gameState, nickname }) {\n//   const [myShips, setMyShips] = useState([]);\n\n//   // Reset ships state when starting a new placement phase\n//   useEffect(() => {\n//     if (gameState?.gameStatus === 'placing' && myShips.length === 0) {\n//       setMyShips(initialShips);\n//     }\n//   }, [gameState?.gameStatus, myShips.length]);\n\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\n//     // ... ‡πÇ‡∏Ñ‡πâ‡∏î canPlaceShip ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ...\n//     // (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î canPlaceShip ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô)\n//     const { length, orientation } = shipToPlace;\n//     const { row, col } = newPosition;\n\n//     if (orientation === 'horizontal') {\n//       if (col < 0 || col + length > 8 || row < 0 || row > 7) return false;\n//     } else { // vertical\n//       if (row < 0 || row + length > 8 || col < 0 || col > 7) return false;\n//     }\n\n//     const newParts = Array.from({ length }).map((_, i) => ({\n//       row: orientation === 'horizontal' ? row : row + i,\n//       col: orientation === 'horizontal' ? col + i : col,\n//     }));\n\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\n//     for (const otherShip of otherShips) {\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\n//       }));\n//       for (const newPart of newParts) {\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\n//           return false;\n//         }\n//       }\n//     }\n//     return true;\n//   };\n\n//   const handleShipDrop = (ship, newPosition) => {\n//     if (canPlaceShip(ship, newPosition, myShips)) {\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\n//     }\n//   };\n\n//   const handleRotateShip = (shipId) => {\n//     setMyShips(ships => ships.map(s => {\n//       if (s.id === shipId) {\n//         const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\n//         if (s.position && !canPlaceShip({ ...s, orientation: newOrientation }, s.position, ships)) {\n//           return s; // ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\n//         }\n//         return { ...s, orientation: newOrientation };\n//       }\n//       return s;\n//     }));\n//   };\n\n//   // Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏π‡πà\n//   const [, dropPalette] = useDrop(() => ({\n//     accept: ItemTypes.SHIP,\n//     drop: (item) => {\n//       setMyShips(ships => ships.map(s => s.id === item.id ? { ...s, position: null } : s));\n//     },\n//   }));\n\n//   const handleConfirmPlacement = () => {\n//      // ... ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° ...\n//   };\n\n//   // ... ‡∏™‡πà‡∏ß‡∏ô Logic ‡πÄ‡∏î‡∏¥‡∏° (‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô, ‡∏¢‡∏¥‡∏á, ‡∏Ø‡∏•‡∏Ø) ...\n\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\n//   const shipsInPalette = myShips.filter(s => s.position === null);\n\n//   // ... ‡∏™‡πà‡∏ß‡∏ô Render ...\n//   return (\n//     <div className=\"game-container\">\n//       {gameState.gameStatus === 'placing' && me.ships.length === 0 && (\n//         <div className=\"placement-container\">\n//           <h3>Place Your Fleet (Click to rotate)</h3>\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} onRotateShip={handleRotateShip} />\n//           <div className=\"ship-palette\" ref={dropPalette}>\n//             {shipsInPalette.length > 0 ? (\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onClick={handleRotateShip} />)\n//             ) : (\n//                 <p>All ships placed. Drag ships to reposition or back here to un-place.</p>\n//             )}\n//           </div>\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\n//         </div>\n//       )}\n\n//       {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Playing ‡πÅ‡∏•‡∏∞ Game Over ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ... */}\n//     </div>\n//   );\n// }\n\n// // export default Game;\n\n////----------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n// // src/components/Game.js\n// import React, { useState, useEffect } from 'react';\n// import { useDrop } from 'react-dnd';\n// import { socket } from '../socket';\n// import GameBoard from './GameBoard';\n// import DraggableShip, { ItemTypes } from './DraggableShip';\n// import './Game.css';\n\n// const initialShips = [\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\n// ];\n\n// function Game({ gameState, nickname }) {\n//   const [myShips, setMyShips] = useState(initialShips);\n\n//   useEffect(() => {\n//     if (gameState?.gameStatus === 'placing' && me?.ships.length === 0) {\n//       setMyShips(initialShips);\n//     }\n//   }, [gameState, nickname]);\n\n//   // --- ‡∏™‡πà‡∏ß‡∏ô Logic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (canPlaceShip, handleShipDrop, ‡∏Ø‡∏•‡∏Ø) ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ---\n//   // ... (‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Logic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ...\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\n//     const { length, orientation } = shipToPlace;\n//     const { row, col } = newPosition;\n\n//     if (orientation === 'horizontal') {\n//       if (col < 0 || col + length > 8 || row < 0 || row > 7) return false;\n//     } else { // vertical\n//       if (row < 0 || row + length > 8 || col < 0 || col > 7) return false;\n//     }\n\n//     const newParts = Array.from({ length }).map((_, i) => ({\n//       row: orientation === 'horizontal' ? row : row + i,\n//       col: orientation === 'horizontal' ? col + i : col,\n//     }));\n\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\n//     for (const otherShip of otherShips) {\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\n//       }));\n//       for (const newPart of newParts) {\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\n//           return false;\n//         }\n//       }\n//     }\n//     return true;\n//   };\n\n//   const handleShipDrop = (ship, newPosition) => {\n//     if (canPlaceShip(ship, newPosition, myShips)) {\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\n//     }\n//   };\n\n//   const handleRotateShip = (shipId) => {\n//     setMyShips(ships => ships.map(s => {\n//       if (s.id === shipId) {\n//         const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\n//         if (s.position && !canPlaceShip({ ...s, orientation: newOrientation }, s.position, ships)) {\n//           return s; // ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\n//         }\n//         return { ...s, orientation: newOrientation };\n//       }\n//       return s;\n//     }));\n//   };\n\n//   const [, dropPalette] = useDrop(() => ({\n//     accept: ItemTypes.SHIP,\n//     drop: (item) => {\n//       setMyShips(ships => ships.map(s => s.id === item.id ? { ...s, position: null } : s));\n//     },\n//   }));\n\n//   const handleConfirmPlacement = () => {\n//     const placedShips = myShips.filter(s => s.position);\n//     if (placedShips.length !== 4) {\n//       alert('Please place all 4 ships on the board.');\n//       return;\n//     }\n//     const allShipParts = [];\n//     placedShips.forEach(ship => {\n//       for (let i = 0; i < ship.length; i++) {\n//         allShipParts.push({\n//           row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\n//           col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\n//         });\n//       }\n//     });\n//     socket.emit('place-ships', allShipParts);\n//   };\n\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\n\n//   const playerIds = Object.keys(gameState.players);\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\n//   if (!myPlayerId) return <div>Initializing...</div>;\n\n//   const me = gameState.players[myPlayerId];\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\n//   const shipsInPalette = myShips.filter(s => s.position === null);\n\n//   // --- ‡∏™‡πà‡∏ß‡∏ô Render ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Logic ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---\n//   return (\n//     <div className=\"game-container\">\n\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (Waiting) ===== */}\n//       {gameState.gameStatus === 'waiting' && (\n//         <div className=\"waiting-room\">\n//           <h2>Welcome, {nickname}!</h2>\n//           <h3>Waiting for another player to join...</h3>\n//         </div>\n//       )}\n\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Placing) ===== */}\n//       {gameState.gameStatus === 'placing' && (\n//         me.ships.length === 0 ? (\n//           <div className=\"placement-container\">\n//             <h3>Place Your Fleet (Click to rotate)</h3>\n//             <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} onRotateShip={handleRotateShip} />\n//             <div className=\"ship-palette\" ref={dropPalette}>\n//               {shipsInPalette.length > 0 ? (\n//                   shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onClick={handleRotateShip} />)\n//               ) : (\n//                   <p>All ships placed. Drag to reposition or back here to un-place.</p>\n//               )}\n//             </div>\n//             <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\n//           </div>\n//         ) : (\n//           <h2>Waiting for opponent to place ships...</h2>\n//         )\n//       )}\n\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô (Playing) ‡πÅ‡∏•‡∏∞‡∏à‡∏ö‡πÄ‡∏Å‡∏° (Game Over) ===== */}\n//       {(gameState.gameStatus === 'playing' || gameState.gameStatus === 'gameover') && (\n//         // ... (‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡∏∞‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà) ...\n//         // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤ opponent\n//         (() => {\n//             const opponentId = playerIds.find(id => id !== myPlayerId);\n//             const opponent = opponentId ? gameState.players[opponentId] : null;\n//             const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\n\n//             const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\n//             me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\n//             me.gameBoard.forEach((row, r_idx) => {\n//                 row.forEach((cell, c_idx) => {\n//                 if (cell === 'hit' || cell === 'miss') {\n//                     myDisplayBoard[r_idx][c_idx] = cell;\n//                 }\n//                 });\n//             });\n\n//             const handleFire = (row, col) => {\n//                 if (isMyTurn && gameState.gameStatus === 'playing') {\n//                 socket.emit('fire-shot', { row, col });\n//                 }\n//             };\n//             return (\n//                 <>\n//                 {gameState.gameStatus === 'playing' && (\n//                     <>\n//                         <div className=\"turn-indicator\">\n//                             <h2 className={isMyTurn ? 'my-turn' : ''}>\n//                             {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\n//                             </h2>\n//                             <div className=\"timer\">Time Left: {gameState.timer}</div>\n//                         </div>\n//                         <div className=\"boards-container\">\n//                             <div className=\"board-area\">\n//                                 <h3>Your Board (Score: {me.score})</h3>\n//                                 <GameBoard ships={[]} boardData={myDisplayBoard} />\n//                             </div>\n//                             <div className=\"board-area\">\n//                                 <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\n//                                 {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\n//                             </div>\n//                         </div>\n//                     </>\n//                 )}\n//                 {gameState.gameStatus === 'gameover' && (<div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\n//                 </>\n//             )\n//         })()\n//       )}\n//     </div>\n//   );\n// }\n\n// export default Game;\n\n// 10/8/2025  18:51\n\n// src/components/Game.js\n// src/components/Game.js\n// src/components/Game.js// src/components/Game.js\n\n// src/components/Game.js// src/components/Game.js\nimport React, { useState, useEffect } from 'react';\nimport { useDrop } from 'react-dnd';\nimport { socket } from '../socket';\nimport GameBoard from './GameBoard';\nimport DraggableShip, { ItemTypes } from './DraggableShip';\nimport './Game.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialShips = [{\n  id: 1,\n  length: 4,\n  position: null,\n  orientation: 'horizontal'\n}, {\n  id: 2,\n  length: 4,\n  position: null,\n  orientation: 'horizontal'\n}, {\n  id: 3,\n  length: 4,\n  position: null,\n  orientation: 'horizontal'\n}, {\n  id: 4,\n  length: 4,\n  position: null,\n  orientation: 'horizontal'\n}];\nfunction Game({\n  gameState,\n  nickname\n}) {\n  _s();\n  const [myShips, setMyShips] = useState(initialShips);\n  const [isPlacementValid, setIsPlacementValid] = useState(false);\n  const myPlayerId = gameState !== null && gameState !== void 0 && gameState.players ? Object.keys(gameState.players).find(id => gameState.players[id].nickname === nickname) : null;\n  const me = myPlayerId ? gameState.players[myPlayerId] : null;\n\n  // --- 1. VALIDATION LOGIC ‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ---\n  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ object: { isValid: boolean, collidedShipId: number | null }\n  const checkPlacement = (shipToCheck, newPosition, allShips) => {\n    const {\n      length,\n      orientation,\n      id: shipId\n    } = shipToCheck;\n\n    // 1a. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï\n    if (newPosition.row < 0 || newPosition.col < 0) return {\n      isValid: false,\n      collidedShipId: null\n    };\n    if (orientation === 'horizontal' && newPosition.col + length > 8) return {\n      isValid: false,\n      collidedShipId: null\n    };\n    if (orientation === 'vertical' && newPosition.row + length > 8) return {\n      isValid: false,\n      collidedShipId: null\n    };\n\n    // 1b. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ß‡∏≤‡∏á\n    const newShipParts = Array.from({\n      length\n    }).map((_, i) => ({\n      row: orientation === 'horizontal' ? newPosition.row : newPosition.row + i,\n      col: orientation === 'horizontal' ? newPosition.col + i : newPosition.col\n    }));\n\n    // 1c. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏≠‡∏∑‡πà‡∏ô\n    const otherShips = allShips.filter(s => s.id !== shipId && s.position);\n    for (const otherShip of otherShips) {\n      const otherShipParts = Array.from({\n        length: otherShip.length\n      }).map((_, i) => ({\n        row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\n        col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col\n      }));\n\n      // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\n      const isColliding = newShipParts.some(p1 => otherShipParts.some(p2 => p1.row === p2.row && p1.col === p2.col));\n      if (isColliding) {\n        return {\n          isValid: false,\n          collidedShipId: otherShip.id\n        }; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ ID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡∏ö\n      }\n    }\n    return {\n      isValid: true,\n      collidedShipId: null\n    }; // ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\n  };\n\n  // --- 2. SHIP MANAGEMENT FUNCTIONS ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Logic ‡πÉ‡∏´‡∏°‡πà ---\n  const handleShipDrop = (droppedShip, newPosition) => {\n    const validationResult = checkPlacement(droppedShip, newPosition, myShips);\n    if (validationResult.isValid) {\n      // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡πÑ‡∏î‡πâ: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡∏°‡∏≤\n      setMyShips(ships => ships.map(s => s.id === droppedShip.id ? {\n        ...s,\n        position: newPosition\n      } : s));\n    } else if (validationResult.collidedShipId) {\n      // ‡∏ñ‡πâ‡∏≤‡∏ó‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏≠‡∏∑‡πà‡∏ô: ‡πÄ‡∏î‡πâ‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏π‡πà ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡∏°‡∏≤‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏ó‡∏ô\n      setMyShips(ships => ships.map(s => {\n        if (s.id === droppedShip.id) return {\n          ...s,\n          position: newPosition\n        };\n        if (s.id === validationResult.collidedShipId) return {\n          ...s,\n          position: null\n        };\n        return s;\n      }));\n    }\n    // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡∏•‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö: ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ (‡πÄ‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏≠‡∏á)\n  };\n  const handleRotateShip = shipId => {\n    setMyShips(ships => ships.map(s => {\n      if (s.id === shipId) {\n        const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\n        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°\n        if (s.position) {\n          const validationResult = checkPlacement({\n            ...s,\n            orientation: newOrientation\n          }, s.position, ships);\n          if (!validationResult.isValid) {\n            return s; // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ó‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°\n          }\n        }\n        return {\n          ...s,\n          orientation: newOrientation\n        };\n      }\n      return s;\n    }));\n  };\n  const [, dropPalette] = useDrop(() => ({\n    accept: ItemTypes.SHIP,\n    drop: item => {\n      setMyShips(ships => ships.map(s => s.id === item.id ? {\n        ...s,\n        position: null\n      } : s));\n    }\n  }));\n\n  // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---\n\n  const validateFullBoard = allShips => {\n    const placedShips = allShips.filter(s => s.position);\n    return placedShips.length === 4;\n  };\n  useEffect(() => {\n    setIsPlacementValid(validateFullBoard(myShips));\n  }, [myShips]);\n  useEffect(() => {\n    if ((gameState === null || gameState === void 0 ? void 0 : gameState.gameStatus) === 'placing' && (me === null || me === void 0 ? void 0 : me.ships.length) === 0) {\n      setMyShips(initialShips);\n    }\n    if ((gameState === null || gameState === void 0 ? void 0 : gameState.gameStatus) === 'waiting') {\n      setMyShips(initialShips);\n    }\n  }, [gameState, me]);\n  const handleConfirmPlacement = () => {\n    // ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ...\n  };\n  if (!gameState || !me) return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Loading or connecting...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1251,\n    columnNumber: 33\n  }, this);\n\n  // --- ‡∏™‡πà‡∏ß‡∏ô Render ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ---\n  if (gameState.gameStatus === 'placing') {\n    // ...\n  }\n  if (gameState.gameStatus === 'playing' || gameState.gameStatus === 'gameover') {\n    // ...\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: \"Unhandled game state...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 1260,\n    columnNumber: 10\n  }, this);\n}\n_s(Game, \"q07GqoW+szPCLmD7PtqYDg1qIlY=\", false, function () {\n  return [useDrop];\n});\n_c = Game;\nexport default Game;\nvar _c;\n$RefreshReg$(_c, \"Game\");","map":{"version":3,"names":["React","useState","useEffect","useDrop","socket","GameBoard","DraggableShip","ItemTypes","jsxDEV","_jsxDEV","initialShips","id","length","position","orientation","Game","gameState","nickname","_s","myShips","setMyShips","isPlacementValid","setIsPlacementValid","myPlayerId","players","Object","keys","find","me","checkPlacement","shipToCheck","newPosition","allShips","shipId","row","col","isValid","collidedShipId","newShipParts","Array","from","map","_","i","otherShips","filter","s","otherShip","otherShipParts","isColliding","some","p1","p2","handleShipDrop","droppedShip","validationResult","ships","handleRotateShip","newOrientation","dropPalette","accept","SHIP","drop","item","validateFullBoard","placedShips","gameStatus","handleConfirmPlacement","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/asus/battleship-client/src/components/Game.js"],"sourcesContent":["// // src/components/Game.js\r\n// import React, { useState } from 'react';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import './Game.css';\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   // State ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ß‡∏≤‡∏á (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Client ‡∏ô‡∏µ‡πâ)\r\n//   const [myShips, setMyShips] = useState([]);\r\n//   const totalShipParts = 16; // 4 ‡∏•‡∏≥ * 4 ‡∏ä‡πà‡∏≠‡∏á = 16 ‡∏ä‡∏¥‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô\r\n\r\n//   // --- 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ---\r\n//   if (!gameState || !gameState.players) {\r\n//     return <div>Loading game...</div>;\r\n//   }\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   const opponentId = playerIds.find(id => id !== myPlayerId);\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const opponent = opponentId ? gameState.players[opponentId] : null;\r\n\r\n//   if (!me) return <div>Initializing...</div>;\r\n\r\n//   const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//   // --- 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Event ---\r\n//   const handlePlacementClick = (row, col) => {\r\n//     if (myShips.length < totalShipParts) {\r\n//       const newPart = { row, col };\r\n//       if (!myShips.some(part => part.row === row && part.col === col)) {\r\n//         setMyShips([...myShips, newPart]);\r\n//       }\r\n//     }\r\n//   };\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//     if (myShips.length === totalShipParts) {\r\n//       socket.emit('place-ships', myShips);\r\n//     } else {\r\n//       alert(`Please place all ${totalShipParts} ship parts.`);\r\n//     }\r\n//   };\r\n\r\n//   const handleFire = (row, col) => {\r\n//     if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//       socket.emit('fire-shot', { row, col });\r\n//     }\r\n//   };\r\n\r\n//   // --- 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• Board ---\r\n//   const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//   // ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å\r\n//   if (gameState.gameStatus === 'placing') {\r\n//     myShips.forEach(part => { myDisplayBoard[part.row][part.col] = 'ship'; });\r\n//   } \r\n//   // ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°: ‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á + ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏®‡∏±‡∏ï‡∏£‡∏π\r\n//   else {\r\n//     me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\r\n//     me.gameBoard.forEach((row, r_idx) => {\r\n//       row.forEach((cell, c_idx) => {\r\n//         if (cell === 'hit' || cell === 'miss') {\r\n//           myDisplayBoard[r_idx][c_idx] = cell;\r\n//         }\r\n//       });\r\n//     });\r\n//   }\r\n\r\n//   // --- 4. Render Component ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏° ---\r\n//   return (\r\n//     <div className=\"game-container\">\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Placing) ===== */}\r\n//       {gameState.gameStatus === 'placing' && (\r\n//         <div>\r\n//           {me.ships.length === 0 ? (\r\n//             <>\r\n//               <h3>Place Your Ships ({myShips.length} / {totalShipParts} parts)</h3>\r\n//               <GameBoard board={myDisplayBoard} onCellClick={handlePlacementClick} />\r\n//               <button onClick={handleConfirmPlacement} disabled={myShips.length !== totalShipParts}>\r\n//                 Confirm Placement\r\n//               </button>\r\n//             </>\r\n//           ) : (\r\n//             <h2>Waiting for {opponent?.nickname || 'opponent'} to place ships...</h2>\r\n//           )}\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô (Playing) ===== */}\r\n//       {gameState.gameStatus === 'playing' && (\r\n//         <>\r\n//           <div className=\"turn-indicator\">\r\n//             <h2 className={isMyTurn ? 'my-turn' : ''}>\r\n//               {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\r\n//             </h2>\r\n//           </div>\r\n//           <div className=\"boards-container\">\r\n//             <div className=\"board-area\">\r\n//               <h3>Your Board (Score: {me.score})</h3>\r\n//               <GameBoard board={myDisplayBoard} onCellClick={() => {}} />\r\n//             </div>\r\n//             <div className=\"board-area\">\r\n//               <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\r\n//               {opponent ? (\r\n//                 <GameBoard board={opponent.gameBoard} onCellClick={handleFire} />\r\n//               ) : (\r\n//                 <p>Waiting for opponent...</p>\r\n//               )}\r\n//             </div>\r\n//           </div>\r\n//         </>\r\n//       )}\r\n\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÄ‡∏Å‡∏°‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß (Game Over) ===== */}\r\n//       {gameState.gameStatus === 'gameover' && (\r\n//         <div className=\"game-over\">\r\n//           <h1>Game Over!</h1>\r\n//           <h2>Winner is: {gameState.players[gameState.winner]?.nickname || 'Someone'}</h2>\r\n//         </div>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n\r\n\r\n// // src/components/Game.js\r\n// import React, { useState } from 'react';\r\n// import { useDrop } from 'react-dnd';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import DraggableShip, { ItemTypes } from './DraggableShip';\r\n// import './Game.css';\r\n\r\n// // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô\r\n// const initialShips = [\r\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   const [myShips, setMyShips] = useState(initialShips);\r\n//   const [shipOrientation, setShipOrientation] = useState('horizontal');\r\n\r\n//   // --- Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Drop) ---\r\n//   const moveShip = (shipId, newPosition) => {\r\n//     setMyShips((prevShips) =>\r\n//       prevShips.map((ship) =>\r\n//         ship.id === shipId\r\n//           ? { ...ship, position: newPosition, orientation: shipOrientation }\r\n//           : ship\r\n//       )\r\n//     );\r\n//   };\r\n\r\n//   const [, drop] = useDrop(() => ({\r\n//     accept: ItemTypes.SHIP,\r\n//     drop: (item, monitor) => {\r\n//       // Logic ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏ô GameBoard ‡πÅ‡∏ó‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô\r\n//     },\r\n//   }));\r\n\r\n\r\n//   // --- Logic ‡πÄ‡∏î‡∏¥‡∏° ‡πÅ‡∏ï‡πà‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ---\r\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   if (!myPlayerId) return <div>Initializing...</div>;\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const opponentId = playerIds.find(id => id !== myPlayerId);\r\n//   const opponent = opponentId ? gameState.players[opponentId] : null;\r\n\r\n//   const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//   // --- ‡∏™‡∏£‡πâ‡∏≤‡∏á Array ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ Server ---\r\n//   const handleConfirmPlacement = () => {\r\n//     const allShipParts = [];\r\n//     myShips.forEach(ship => {\r\n//       if (ship.position) {\r\n//         for (let i = 0; i < ship.length; i++) {\r\n//           const part = {\r\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\r\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\r\n//           };\r\n//           allShipParts.push(part);\r\n//         }\r\n//       }\r\n//     });\r\n\r\n//     if (allShipParts.length === 16) {\r\n//         socket.emit('place-ships', allShipParts);\r\n//     } else {\r\n//         alert('Please place all 4 ships on the board.');\r\n//     }\r\n//   };\r\n\r\n//   const handleFire = (row, col) => {\r\n//     if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//       socket.emit('fire-shot', { row, col });\r\n//     }\r\n//   };\r\n  \r\n//   // --- ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Board ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ---\r\n//   const placementBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//   myShips.forEach(ship => {\r\n//     if (ship.position) {\r\n//       for (let i = 0; i < ship.length; i++) {\r\n//         const row = ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i;\r\n//         const col = ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col;\r\n//         if (row < 8 && col < 8) {\r\n//           placementBoard[row][col] = 'ship';\r\n//         }\r\n//       }\r\n//     }\r\n//   });\r\n  \r\n//   // -- ‡∏™‡πà‡∏ß‡∏ô Render --\r\n//   return (\r\n//     <div className=\"game-container\" ref={drop}>\r\n//       {gameState.gameStatus === 'placing' && (\r\n//         <div className=\"placement-container\">\r\n//           {me.ships.length === 0 ? (\r\n//             <>\r\n//               <h3>Place Your Fleet</h3>\r\n//               <GameBoard board={placementBoard} onDropShip={moveShip} />\r\n//               <div className=\"ship-palette\">\r\n//                 <div className=\"ships-to-drag\">\r\n//                     {myShips.filter(s => s.position === null).map(s => <DraggableShip key={s.id} ship={s} />)}\r\n//                 </div>\r\n//                 <button onClick={() => setShipOrientation(o => o === 'horizontal' ? 'vertical' : 'horizontal')}>\r\n//                   Rotate (Now: {shipOrientation})\r\n//                 </button>\r\n//               </div>\r\n//               <button onClick={handleConfirmPlacement}>Confirm Placement</button>\r\n//             </>\r\n//           ) : (\r\n//             <h2>Waiting for opponent...</h2>\r\n//           )}\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* --- ‡∏™‡πà‡∏ß‡∏ô Playing ‡πÅ‡∏•‡∏∞ Game Over (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) --- */}\r\n//       {gameState.gameStatus === 'playing' && (\r\n//         <>\r\n//             {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Playing ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ... */}\r\n//         </>\r\n//       )}\r\n//       {gameState.gameStatus === 'gameover' && (\r\n//         <>\r\n//             {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Game Over ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß ... */}\r\n//         </>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n\r\n\r\n\r\n\r\n\r\n// //v \r\n// // src/components/Game.js\r\n// import React, { useState } from 'react';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import DraggableShip from './DraggableShip';\r\n// import './Game.css';\r\n\r\n// // Initial state for the four ships\r\n// const initialShips = [\r\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   const [myShips, setMyShips] = useState(initialShips);\r\n  \r\n//   // --- 1. CORE VALIDATION LOGIC ---\r\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\r\n//     const { length, orientation } = shipToPlace;\r\n//     const { row, col } = newPosition;\r\n\r\n//     // Boundary Check: Ensure the ship does not go off the board\r\n//     if (orientation === 'horizontal') {\r\n//       if (col < 0 || col + length > 8) return false;\r\n//     } else { // vertical\r\n//       if (row < 0 || row + length > 8) return false;\r\n//     }\r\n\r\n//     // Collision Check: Ensure the ship does not overlap with others\r\n//     const newParts = Array.from({ length }).map((_, i) => ({\r\n//       row: orientation === 'horizontal' ? row : row + i,\r\n//       col: orientation === 'horizontal' ? col + i : col,\r\n//     }));\r\n\r\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\r\n//     for (const otherShip of otherShips) {\r\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n//       }));\r\n      \r\n//       for (const newPart of newParts) {\r\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\r\n//           return false; // Collision detected\r\n//         }\r\n//       }\r\n//     }\r\n//     return true; // Placement is valid\r\n//   };\r\n\r\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\r\n//   const handleShipDrop = (ship, newPosition) => {\r\n//     if (canPlaceShip(ship, newPosition, myShips)) {\r\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\r\n//     } else {\r\n//       console.log(\"Invalid placement.\");\r\n//     }\r\n//   };\r\n\r\n//   const handleRotatePaletteShip = (shipId) => {\r\n//     setMyShips(ships => ships.map(s => \r\n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\r\n//     ));\r\n//   };\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//     const placedShips = myShips.filter(s => s.position);\r\n//     if (placedShips.length !== 4) {\r\n//       alert('Please place all 4 ships on the board.');\r\n//       return;\r\n//     }\r\n//     const allShipParts = [];\r\n//     placedShips.forEach(ship => {\r\n//         for (let i = 0; i < ship.length; i++) {\r\n//             allShipParts.push({\r\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\r\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\r\n//             });\r\n//         }\r\n//     });\r\n//     socket.emit('place-ships', allShipParts);\r\n//   };\r\n  \r\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\r\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   if (!myPlayerId) return <div>Initializing...</div>;\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\r\n//   const shipsInPalette = myShips.filter(s => s.position === null);\r\n\r\n//   // This part is for rendering the full game after placement is done\r\n//   // It is simplified here to avoid mixing code from different stages\r\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\r\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\r\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\r\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\r\n//       me.gameBoard.forEach((row, r_idx) => {\r\n//           row.forEach((cell, c_idx) => {\r\n//           if (cell === 'hit' || cell === 'miss') {\r\n//               myDisplayBoard[r_idx][c_idx] = cell;\r\n//           }\r\n//           });\r\n//       });\r\n      \r\n//       const handleFire = (row, col) => {\r\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//               socket.emit('fire-shot', { row, col });\r\n//           }\r\n//       };\r\n\r\n//       return (\r\n//         <div className=\"game-container\">\r\n//             {gameState.gameStatus === 'playing' && (\r\n//                 <>\r\n//                   <div className=\"turn-indicator\">\r\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\r\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\r\n//                     </h2>\r\n//                   </div>\r\n//                   <div className=\"boards-container\">\r\n//                     <div className=\"board-area\">\r\n//                       <h3>Your Board (Score: {me.score})</h3>\r\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\r\n//                     </div>\r\n//                     <div className=\"board-area\">\r\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\r\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\r\n//                     </div>\r\n//                   </div>\r\n//                 </>\r\n//             )}\r\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\r\n//         </div>\r\n//       );\r\n//   }\r\n\r\n//   // This is the renderer for the ship placement phase\r\n//   return (\r\n//     <div className=\"game-container\">\r\n//       {me.ships.length === 0 ? (\r\n//         <div className=\"placement-container\">\r\n//           <h3>Place Your Fleet</h3>\r\n//           <p>Click ships in the palette to rotate them.</p>\r\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\r\n//           <div className=\"ship-palette\">\r\n//             {shipsInPalette.length > 0 ? (\r\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\r\n//             ) : (\r\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\r\n//             )}\r\n//           </div>\r\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\r\n//         </div>\r\n//       ) : (\r\n//           <h2>Waiting for opponent to place ships...</h2>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n\r\n//v55\r\n// src/components/Game.js\r\n// //v \r\n// // src/components/Game.js\r\n// import React, { useState } from 'react';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import DraggableShip from './DraggableShip';\r\n// import './Game.css';\r\n\r\n// // Initial state for the four ships\r\n// const initialShips = [\r\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   const [myShips, setMyShips] = useState(initialShips);\r\n  \r\n//   // --- 1. CORE VALIDATION LOGIC ---\r\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\r\n//     const { length, orientation } = shipToPlace;\r\n//     const { row, col } = newPosition;\r\n\r\n//     // Boundary Check: Ensure the ship does not go off the board\r\n//     if (orientation === 'horizontal') {\r\n//       if (col < 0 || col + length > 8) return false;\r\n//     } else { // vertical\r\n//       if (row < 0 || row + length > 8) return false;\r\n//     }\r\n\r\n//     // Collision Check: Ensure the ship does not overlap with others\r\n//     const newParts = Array.from({ length }).map((_, i) => ({\r\n//       row: orientation === 'horizontal' ? row : row + i,\r\n//       col: orientation === 'horizontal' ? col + i : col,\r\n//     }));\r\n\r\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\r\n//     for (const otherShip of otherShips) {\r\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n//       }));\r\n      \r\n//       for (const newPart of newParts) {\r\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\r\n//           return false; // Collision detected\r\n//         }\r\n//       }\r\n//     }\r\n//     return true; // Placement is valid\r\n//   };\r\n\r\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\r\n//   const handleShipDrop = (ship, newPosition) => {\r\n//     if (canPlaceShip(ship, newPosition, myShips)) {\r\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\r\n//     } else {\r\n//       console.log(\"Invalid placement.\");\r\n//     }\r\n//   };\r\n\r\n//   const handleRotatePaletteShip = (shipId) => {\r\n//     setMyShips(ships => ships.map(s => \r\n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\r\n//     ));\r\n//   };\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//     const placedShips = myShips.filter(s => s.position);\r\n//     if (placedShips.length !== 4) {\r\n//       alert('Please place all 4 ships on the board.');\r\n//       return;\r\n//     }\r\n//     const allShipParts = [];\r\n//     placedShips.forEach(ship => {\r\n//         for (let i = 0; i < ship.length; i++) {\r\n//             allShipParts.push({\r\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\r\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\r\n//             });\r\n//         }\r\n//     });\r\n//     socket.emit('place-ships', allShipParts);\r\n//   };\r\n  \r\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\r\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   if (!myPlayerId) return <div>Initializing...</div>;\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\r\n//   const shipsInPalette = myShips.filter(s => s.position === null);\r\n\r\n//   // This part is for rendering the full game after placement is done\r\n//   // It is simplified here to avoid mixing code from different stages\r\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\r\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\r\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\r\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\r\n//       me.gameBoard.forEach((row, r_idx) => {\r\n//           row.forEach((cell, c_idx) => {\r\n//           if (cell === 'hit' || cell === 'miss') {\r\n//               myDisplayBoard[r_idx][c_idx] = cell;\r\n//           }\r\n//           });\r\n//       });\r\n      \r\n//       const handleFire = (row, col) => {\r\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//               socket.emit('fire-shot', { row, col });\r\n//           }\r\n//       };\r\n\r\n//       return (\r\n//         <div className=\"game-container\">\r\n//             {gameState.gameStatus === 'playing' && (\r\n//                 <>\r\n//                   <div className=\"turn-indicator\">\r\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\r\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\r\n//                     </h2>\r\n//                   </div>\r\n//                   <div className=\"boards-container\">\r\n//                     <div className=\"board-area\">\r\n//                       <h3>Your Board (Score: {me.score})</h3>\r\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\r\n//                     </div>\r\n//                     <div className=\"board-area\">\r\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\r\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\r\n//                     </div>\r\n//                   </div>\r\n//                 </>\r\n//             )}\r\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\r\n//         </div>\r\n//       );\r\n//   }\r\n\r\n//   // This is the renderer for the ship placement phase\r\n//   return (\r\n//     <div className=\"game-container\">\r\n//       {me.ships.length === 0 ? (\r\n//         <div className=\"placement-container\">\r\n//           <h3>Place Your Fleet</h3>\r\n//           <p>Click ships in the palette to rotate them.</p>\r\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\r\n//           <div className=\"ship-palette\">\r\n//             {shipsInPalette.length > 0 ? (\r\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\r\n//             ) : (\r\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\r\n//             )}\r\n//           </div>\r\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\r\n//         </div>\r\n//       ) : (\r\n//           <h2>Waiting for opponent to place ships...</h2>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n\r\n\r\n\r\n\r\n\r\n///////------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n// import React, { useState } from 'react'; \r\n// import { useDrop } from 'react-dnd';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import DraggableShip from './DraggableShip';\r\n// import './Game.css';\r\n\r\n// // Initial state for the four ships\r\n// const initialShips = [\r\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   // const [myShips, setMyShips] = useState(initialShips);\r\n//   const [myShips, setMyShips] = useState([]);\r\n\r\n//   // Reset ships state when starting a new placement phase\r\n//   useEffect(() => {\r\n//     if (gameState?.gameStatus === 'placing' && myShips.length === 0) {\r\n//       setMyShips(initialShips);\r\n//     }\r\n//   }, [gameState?.gameStatus, myShips.length]);\r\n  \r\n  \r\n//   // --- 1. CORE VALIDATION LOGIC ---\r\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\r\n//     const { length, orientation } = shipToPlace;\r\n//     const { row, col } = newPosition;\r\n\r\n//     // Boundary Check: Ensure the ship does not go off the board\r\n//     if (orientation === 'horizontal') {\r\n//       if (col < 0 || col + length > 8) return false;\r\n//     } else { // vertical\r\n//       if (row < 0 || row + length > 8) return false;\r\n//     }\r\n\r\n//     // Collision Check: Ensure the ship does not overlap with others\r\n//     const newParts = Array.from({ length }).map((_, i) => ({\r\n//       row: orientation === 'horizontal' ? row : row + i,\r\n//       col: orientation === 'horizontal' ? col + i : col,\r\n//     }));\r\n\r\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\r\n//     for (const otherShip of otherShips) {\r\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n//       }));\r\n      \r\n//       for (const newPart of newParts) {\r\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\r\n//           return false; // Collision detected\r\n//         }\r\n//       }\r\n//     }\r\n//     return true; // Placement is valid\r\n//   };\r\n\r\n//   // --- 2. SHIP MANAGEMENT FUNCTIONS ---\r\n//   const handleShipDrop = (ship, newPosition) => {\r\n//     if (canPlaceShip(ship, newPosition, myShips)) {\r\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\r\n//     } else {\r\n//       console.log(\"Invalid placement.\");\r\n//     }\r\n//   };\r\n\r\n//   const handleRotatePaletteShip = (shipId) => {\r\n//     setMyShips(ships => ships.map(s => \r\n//       s.id === shipId ? { ...s, orientation: s.orientation === 'horizontal' ? 'vertical' : 'horizontal' } : s\r\n//     ));\r\n//   };\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//     const placedShips = myShips.filter(s => s.position);\r\n//     if (placedShips.length !== 4) {\r\n//       alert('Please place all 4 ships on the board.');\r\n//       return;\r\n//     }\r\n//     const allShipParts = [];\r\n//     placedShips.forEach(ship => {\r\n//         for (let i = 0; i < ship.length; i++) {\r\n//             allShipParts.push({\r\n//             row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\r\n//             col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\r\n//             });\r\n//         }\r\n//     });\r\n//     socket.emit('place-ships', allShipParts);\r\n//   };\r\n  \r\n//   // --- 3. STANDARD GAME LOGIC & RENDER ---\r\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   if (!myPlayerId) return <div>Initializing...</div>;\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\r\n//   const shipsInPalette = myShips.filter(s => s.position === null);\r\n\r\n//   // This part is for rendering the full game after placement is done\r\n//   // It is simplified here to avoid mixing code from different stages\r\n//   if (gameState.gameStatus !== 'placing' && me.ships.length > 0) {\r\n//       const opponentId = playerIds.find(id => id !== myPlayerId);\r\n//       const opponent = opponentId ? gameState.players[opponentId] : null;\r\n//       const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//       const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//       me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\r\n//       me.gameBoard.forEach((row, r_idx) => {\r\n//           row.forEach((cell, c_idx) => {\r\n//           if (cell === 'hit' || cell === 'miss') {\r\n//               myDisplayBoard[r_idx][c_idx] = cell;\r\n//           }\r\n//           });\r\n//       });\r\n      \r\n//       const handleFire = (row, col) => {\r\n//           if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//               socket.emit('fire-shot', { row, col });\r\n//           }\r\n//       };\r\n\r\n//       return (\r\n//         <div className=\"game-container\">\r\n//             {gameState.gameStatus === 'playing' && (\r\n//                 <>\r\n//                   <div className=\"turn-indicator\">\r\n//                     <h2 className={isMyTurn ? 'my-turn' : ''}>\r\n//                       {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\r\n//                     </h2>\r\n//                   </div>\r\n//                   <div className=\"boards-container\">\r\n//                     <div className=\"board-area\">\r\n//                       <h3>Your Board (Score: {me.score})</h3>\r\n//                       <GameBoard ships={[]} /> {/* We draw hits/misses directly on the board now */}\r\n//                     </div>\r\n//                     <div className=\"board-area\">\r\n//                       <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\r\n//                       {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\r\n//                     </div>\r\n//                   </div>\r\n//                 </>\r\n//             )}\r\n//              {gameState.gameStatus === 'gameover' && ( <div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\r\n//         </div>\r\n//       );\r\n//   }\r\n\r\n//   // This is the renderer for the ship placement phase\r\n//   return (\r\n//     <div className=\"game-container\">\r\n//       {me.ships.length === 0 ? (\r\n//         <div className=\"placement-container\">\r\n//           <h3>Place Your Fleet</h3>\r\n//           <p>Click ships in the palette to rotate them.</p>\r\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} />\r\n//           <div className=\"ship-palette\">\r\n//             {shipsInPalette.length > 0 ? (\r\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onRotate={handleRotatePaletteShip} />)\r\n//             ) : (\r\n//                 <p>All ships placed. Drag them on the board to reposition.</p>\r\n//             )}\r\n//           </div>\r\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\r\n//         </div>\r\n//       ) : (\r\n//           <h2>Waiting for opponent to place ships...</h2>\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n// //-------------------------------------------------------------------------------------------------------------------------------\r\n// // import React, { useState, useEffect } from 'react';\r\n// // import { useDrop } from 'react-dnd'; // <-- ‡πÄ‡∏û‡∏¥‡πà‡∏° useDrop ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà\r\n// // import { socket } from '../socket';\r\n// // import GameBoard from './GameBoard';\r\n// // import DraggableShip, { ItemTypes } from './DraggableShip';\r\n// // import './Game.css';\r\n\r\n// // const initialShips = [\r\n// //   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n// //   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n// //   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n// //   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// // ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   const [myShips, setMyShips] = useState([]);\r\n\r\n//   // Reset ships state when starting a new placement phase\r\n//   useEffect(() => {\r\n//     if (gameState?.gameStatus === 'placing' && myShips.length === 0) {\r\n//       setMyShips(initialShips);\r\n//     }\r\n//   }, [gameState?.gameStatus, myShips.length]);\r\n\r\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\r\n//     // ... ‡πÇ‡∏Ñ‡πâ‡∏î canPlaceShip ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡∏à‡∏≤‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤ ...\r\n//     // (‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î canPlaceShip ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô)\r\n//     const { length, orientation } = shipToPlace;\r\n//     const { row, col } = newPosition;\r\n\r\n//     if (orientation === 'horizontal') {\r\n//       if (col < 0 || col + length > 8 || row < 0 || row > 7) return false;\r\n//     } else { // vertical\r\n//       if (row < 0 || row + length > 8 || col < 0 || col > 7) return false;\r\n//     }\r\n\r\n//     const newParts = Array.from({ length }).map((_, i) => ({\r\n//       row: orientation === 'horizontal' ? row : row + i,\r\n//       col: orientation === 'horizontal' ? col + i : col,\r\n//     }));\r\n\r\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\r\n//     for (const otherShip of otherShips) {\r\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n//       }));\r\n//       for (const newPart of newParts) {\r\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\r\n//           return false;\r\n//         }\r\n//       }\r\n//     }\r\n//     return true;\r\n//   };\r\n\r\n//   const handleShipDrop = (ship, newPosition) => {\r\n//     if (canPlaceShip(ship, newPosition, myShips)) {\r\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\r\n//     }\r\n//   };\r\n\r\n//   const handleRotateShip = (shipId) => {\r\n//     setMyShips(ships => ships.map(s => {\r\n//       if (s.id === shipId) {\r\n//         const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\r\n//         if (s.position && !canPlaceShip({ ...s, orientation: newOrientation }, s.position, ships)) {\r\n//           return s; // ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\r\n//         }\r\n//         return { ...s, orientation: newOrientation };\r\n//       }\r\n//       return s;\r\n//     }));\r\n//   };\r\n  \r\n//   // Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏π‡πà\r\n//   const [, dropPalette] = useDrop(() => ({\r\n//     accept: ItemTypes.SHIP,\r\n//     drop: (item) => {\r\n//       setMyShips(ships => ships.map(s => s.id === item.id ? { ...s, position: null } : s));\r\n//     },\r\n//   }));\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//      // ... ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° ...\r\n//   };\r\n  \r\n//   // ... ‡∏™‡πà‡∏ß‡∏ô Logic ‡πÄ‡∏î‡∏¥‡∏° (‡∏´‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô, ‡∏¢‡∏¥‡∏á, ‡∏Ø‡∏•‡∏Ø) ...\r\n\r\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\r\n//   const shipsInPalette = myShips.filter(s => s.position === null);\r\n\r\n//   // ... ‡∏™‡πà‡∏ß‡∏ô Render ...\r\n//   return (\r\n//     <div className=\"game-container\">\r\n//       {gameState.gameStatus === 'placing' && me.ships.length === 0 && (\r\n//         <div className=\"placement-container\">\r\n//           <h3>Place Your Fleet (Click to rotate)</h3>\r\n//           <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} onRotateShip={handleRotateShip} />\r\n//           <div className=\"ship-palette\" ref={dropPalette}>\r\n//             {shipsInPalette.length > 0 ? (\r\n//                 shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onClick={handleRotateShip} />)\r\n//             ) : (\r\n//                 <p>All ships placed. Drag ships to reposition or back here to un-place.</p>\r\n//             )}\r\n//           </div>\r\n//           <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\r\n//         </div>\r\n//       )}\r\n        \r\n//       {/* ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Playing ‡πÅ‡∏•‡∏∞ Game Over ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ... */}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// // export default Game;\r\n\r\n\r\n\r\n////----------------------------------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\n// // src/components/Game.js\r\n// import React, { useState, useEffect } from 'react';\r\n// import { useDrop } from 'react-dnd';\r\n// import { socket } from '../socket';\r\n// import GameBoard from './GameBoard';\r\n// import DraggableShip, { ItemTypes } from './DraggableShip';\r\n// import './Game.css';\r\n\r\n// const initialShips = [\r\n//   { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n//   { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n// ];\r\n\r\n// function Game({ gameState, nickname }) {\r\n//   const [myShips, setMyShips] = useState(initialShips);\r\n\r\n//   useEffect(() => {\r\n//     if (gameState?.gameStatus === 'placing' && me?.ships.length === 0) {\r\n//       setMyShips(initialShips);\r\n//     }\r\n//   }, [gameState, nickname]);\r\n\r\n\r\n//   // --- ‡∏™‡πà‡∏ß‡∏ô Logic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (canPlaceShip, handleShipDrop, ‡∏Ø‡∏•‡∏Ø) ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ---\r\n//   // ... (‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô Logic ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ) ...\r\n//   const canPlaceShip = (shipToPlace, newPosition, allShips) => {\r\n//     const { length, orientation } = shipToPlace;\r\n//     const { row, col } = newPosition;\r\n\r\n//     if (orientation === 'horizontal') {\r\n//       if (col < 0 || col + length > 8 || row < 0 || row > 7) return false;\r\n//     } else { // vertical\r\n//       if (row < 0 || row + length > 8 || col < 0 || col > 7) return false;\r\n//     }\r\n\r\n//     const newParts = Array.from({ length }).map((_, i) => ({\r\n//       row: orientation === 'horizontal' ? row : row + i,\r\n//       col: orientation === 'horizontal' ? col + i : col,\r\n//     }));\r\n\r\n//     const otherShips = allShips.filter(s => s.id !== shipToPlace.id && s.position);\r\n//     for (const otherShip of otherShips) {\r\n//       const otherParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n//         row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n//         col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n//       }));\r\n//       for (const newPart of newParts) {\r\n//         if (otherParts.some(p => p.row === newPart.row && p.col === newPart.col)) {\r\n//           return false;\r\n//         }\r\n//       }\r\n//     }\r\n//     return true;\r\n//   };\r\n\r\n//   const handleShipDrop = (ship, newPosition) => {\r\n//     if (canPlaceShip(ship, newPosition, myShips)) {\r\n//       setMyShips(ships => ships.map(s => s.id === ship.id ? { ...s, position: newPosition } : s));\r\n//     }\r\n//   };\r\n\r\n//   const handleRotateShip = (shipId) => {\r\n//     setMyShips(ships => ships.map(s => {\r\n//       if (s.id === shipId) {\r\n//         const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\r\n//         if (s.position && !canPlaceShip({ ...s, orientation: newOrientation }, s.position, ships)) {\r\n//           return s; // ‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\r\n//         }\r\n//         return { ...s, orientation: newOrientation };\r\n//       }\r\n//       return s;\r\n//     }));\r\n//   };\r\n  \r\n//   const [, dropPalette] = useDrop(() => ({\r\n//     accept: ItemTypes.SHIP,\r\n//     drop: (item) => {\r\n//       setMyShips(ships => ships.map(s => s.id === item.id ? { ...s, position: null } : s));\r\n//     },\r\n//   }));\r\n\r\n//   const handleConfirmPlacement = () => {\r\n//     const placedShips = myShips.filter(s => s.position);\r\n//     if (placedShips.length !== 4) {\r\n//       alert('Please place all 4 ships on the board.');\r\n//       return;\r\n//     }\r\n//     const allShipParts = [];\r\n//     placedShips.forEach(ship => {\r\n//       for (let i = 0; i < ship.length; i++) {\r\n//         allShipParts.push({\r\n//           row: ship.orientation === 'horizontal' ? ship.position.row : ship.position.row + i,\r\n//           col: ship.orientation === 'horizontal' ? ship.position.col + i : ship.position.col,\r\n//         });\r\n//       }\r\n//     });\r\n//     socket.emit('place-ships', allShipParts);\r\n//   };\r\n  \r\n  \r\n//   if (!gameState || !gameState.players) return <div>Loading...</div>;\r\n\r\n//   const playerIds = Object.keys(gameState.players);\r\n//   const myPlayerId = playerIds.find(id => gameState.players[id].nickname === nickname);\r\n//   if (!myPlayerId) return <div>Initializing...</div>;\r\n\r\n//   const me = gameState.players[myPlayerId];\r\n//   const shipsOnBoard = myShips.filter(s => s.position !== null);\r\n//   const shipsInPalette = myShips.filter(s => s.position === null);\r\n\r\n//   // --- ‡∏™‡πà‡∏ß‡∏ô Render ‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Logic ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---\r\n//   return (\r\n//     <div className=\"game-container\">\r\n\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (Waiting) ===== */}\r\n//       {gameState.gameStatus === 'waiting' && (\r\n//         <div className=\"waiting-room\">\r\n//           <h2>Welcome, {nickname}!</h2>\r\n//           <h3>Waiting for another player to join...</h3>\r\n//         </div>\r\n//       )}\r\n\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠ (Placing) ===== */}\r\n//       {gameState.gameStatus === 'placing' && (\r\n//         me.ships.length === 0 ? (\r\n//           <div className=\"placement-container\">\r\n//             <h3>Place Your Fleet (Click to rotate)</h3>\r\n//             <GameBoard ships={shipsOnBoard} onDropShip={handleShipDrop} onRotateShip={handleRotateShip} />\r\n//             <div className=\"ship-palette\" ref={dropPalette}>\r\n//               {shipsInPalette.length > 0 ? (\r\n//                   shipsInPalette.map(s => <DraggableShip key={s.id} ship={s} onClick={handleRotateShip} />)\r\n//               ) : (\r\n//                   <p>All ships placed. Drag to reposition or back here to un-place.</p>\r\n//               )}\r\n//             </div>\r\n//             <button onClick={handleConfirmPlacement} disabled={shipsOnBoard.length !== 4}>Confirm Placement</button>\r\n//           </div>\r\n//         ) : (\r\n//           <h2>Waiting for opponent to place ships...</h2>\r\n//         )\r\n//       )}\r\n\r\n//       {/* ===== ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô (Playing) ‡πÅ‡∏•‡∏∞‡∏à‡∏ö‡πÄ‡∏Å‡∏° (Game Over) ===== */}\r\n//       {(gameState.gameStatus === 'playing' || gameState.gameStatus === 'gameover') && (\r\n//         // ... (‡∏ß‡∏≤‡∏á‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏°‡πÅ‡∏•‡∏∞‡∏à‡∏ö‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏ß‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà) ...\r\n//         // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏≤ opponent\r\n//         (() => {\r\n//             const opponentId = playerIds.find(id => id !== myPlayerId);\r\n//             const opponent = opponentId ? gameState.players[opponentId] : null;\r\n//             const isMyTurn = gameState.currentPlayerTurn === myPlayerId;\r\n\r\n//             const myDisplayBoard = Array(8).fill(null).map(() => Array(8).fill(null));\r\n//             me.ships.forEach(ship => { myDisplayBoard[ship.row][ship.col] = 'ship'; });\r\n//             me.gameBoard.forEach((row, r_idx) => {\r\n//                 row.forEach((cell, c_idx) => {\r\n//                 if (cell === 'hit' || cell === 'miss') {\r\n//                     myDisplayBoard[r_idx][c_idx] = cell;\r\n//                 }\r\n//                 });\r\n//             });\r\n\r\n//             const handleFire = (row, col) => {\r\n//                 if (isMyTurn && gameState.gameStatus === 'playing') {\r\n//                 socket.emit('fire-shot', { row, col });\r\n//                 }\r\n//             };\r\n//             return (\r\n//                 <>\r\n//                 {gameState.gameStatus === 'playing' && (\r\n//                     <>\r\n//                         <div className=\"turn-indicator\">\r\n//                             <h2 className={isMyTurn ? 'my-turn' : ''}>\r\n//                             {isMyTurn ? \"üî• Your Turn!\" : `Waiting for ${opponent?.nickname}'s turn...`}\r\n//                             </h2>\r\n//                             <div className=\"timer\">Time Left: {gameState.timer}</div>\r\n//                         </div>\r\n//                         <div className=\"boards-container\">\r\n//                             <div className=\"board-area\">\r\n//                                 <h3>Your Board (Score: {me.score})</h3>\r\n//                                 <GameBoard ships={[]} boardData={myDisplayBoard} />\r\n//                             </div>\r\n//                             <div className=\"board-area\">\r\n//                                 <h3>{opponent?.nickname}'s Board (Score: {opponent?.score || 0})</h3>\r\n//                                 {opponent ? <GameBoard ships={[]} onCellClick={handleFire} boardData={opponent.gameBoard} /> : <p>Waiting...</p>}\r\n//                             </div>\r\n//                         </div>\r\n//                     </>\r\n//                 )}\r\n//                 {gameState.gameStatus === 'gameover' && (<div className=\"game-over\"><h1>Game Over!</h1><h2>Winner is: {gameState.players[gameState.winner]?.nickname}</h2></div>)}\r\n//                 </>\r\n//             )\r\n//         })()\r\n//       )}\r\n//     </div>\r\n//   );\r\n// }\r\n\r\n// export default Game;\r\n\r\n\r\n// 10/8/2025  18:51\r\n\r\n// src/components/Game.js\r\n// src/components/Game.js\r\n// src/components/Game.js// src/components/Game.js\r\n\r\n\r\n// src/components/Game.js// src/components/Game.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useDrop } from 'react-dnd';\r\nimport { socket } from '../socket';\r\nimport GameBoard from './GameBoard';\r\nimport DraggableShip, { ItemTypes } from './DraggableShip';\r\nimport './Game.css';\r\n\r\nconst initialShips = [\r\n  { id: 1, length: 4, position: null, orientation: 'horizontal' },\r\n  { id: 2, length: 4, position: null, orientation: 'horizontal' },\r\n  { id: 3, length: 4, position: null, orientation: 'horizontal' },\r\n  { id: 4, length: 4, position: null, orientation: 'horizontal' },\r\n];\r\n\r\nfunction Game({ gameState, nickname }) {\r\n  const [myShips, setMyShips] = useState(initialShips);\r\n  const [isPlacementValid, setIsPlacementValid] = useState(false);\r\n\r\n  const myPlayerId = gameState?.players ? Object.keys(gameState.players).find(id => gameState.players[id].nickname === nickname) : null;\r\n  const me = myPlayerId ? gameState.players[myPlayerId] : null;\r\n\r\n  // --- 1. VALIDATION LOGIC ‡∏ó‡∏µ‡πà‡∏¢‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà ---\r\n  // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ object: { isValid: boolean, collidedShipId: number | null }\r\n  const checkPlacement = (shipToCheck, newPosition, allShips) => {\r\n    const { length, orientation, id: shipId } = shipToCheck;\r\n\r\n    // 1a. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï\r\n    if (newPosition.row < 0 || newPosition.col < 0) return { isValid: false, collidedShipId: null };\r\n    if (orientation === 'horizontal' && newPosition.col + length > 8) return { isValid: false, collidedShipId: null };\r\n    if (orientation === 'vertical' && newPosition.row + length > 8) return { isValid: false, collidedShipId: null };\r\n\r\n    // 1b. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏∞‡∏ß‡∏≤‡∏á\r\n    const newShipParts = Array.from({ length }).map((_, i) => ({\r\n      row: orientation === 'horizontal' ? newPosition.row : newPosition.row + i,\r\n      col: orientation === 'horizontal' ? newPosition.col + i : newPosition.col,\r\n    }));\r\n\r\n    // 1c. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏≠‡∏∑‡πà‡∏ô\r\n    const otherShips = allShips.filter(s => s.id !== shipId && s.position);\r\n    for (const otherShip of otherShips) {\r\n      const otherShipParts = Array.from({ length: otherShip.length }).map((_, i) => ({\r\n        row: otherShip.orientation === 'horizontal' ? otherShip.position.row : otherShip.position.row + i,\r\n        col: otherShip.orientation === 'horizontal' ? otherShip.position.col + i : otherShip.position.col,\r\n      }));\r\n\r\n      // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡πÑ‡∏´‡∏ô‡∏ó‡∏±‡∏ö‡∏Å‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà\r\n      const isColliding = newShipParts.some(p1 => otherShipParts.some(p2 => p1.row === p2.row && p1.col === p2.col));\r\n      if (isColliding) {\r\n        return { isValid: false, collidedShipId: otherShip.id }; // ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤ ID ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡∏ö\r\n      }\r\n    }\r\n\r\n    return { isValid: true, collidedShipId: null }; // ‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á\r\n  };\r\n  \r\n  // --- 2. SHIP MANAGEMENT FUNCTIONS ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ Logic ‡πÉ‡∏´‡∏°‡πà ---\r\n  const handleShipDrop = (droppedShip, newPosition) => {\r\n    const validationResult = checkPlacement(droppedShip, newPosition, myShips);\r\n\r\n    if (validationResult.isValid) {\r\n      // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡πÑ‡∏î‡πâ: ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡∏°‡∏≤\r\n      setMyShips(ships => ships.map(s => s.id === droppedShip.id ? { ...s, position: newPosition } : s));\r\n    } else if (validationResult.collidedShipId) {\r\n      // ‡∏ñ‡πâ‡∏≤‡∏ó‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏≠‡∏∑‡πà‡∏ô: ‡πÄ‡∏î‡πâ‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏•‡∏≥‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ó‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏≠‡∏π‡πà ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏∑‡∏≠‡∏ó‡∏µ‡πà‡∏•‡∏≤‡∏Å‡∏°‡∏≤‡∏•‡∏á‡πÑ‡∏õ‡πÅ‡∏ó‡∏ô\r\n      setMyShips(ships => ships.map(s => {\r\n        if (s.id === droppedShip.id) return { ...s, position: newPosition };\r\n        if (s.id === validationResult.collidedShipId) return { ...s, position: null };\r\n        return s;\r\n      }));\r\n    }\r\n    // ‡∏ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡∏•‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö: ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏≠‡∏∞‡πÑ‡∏£‡πÄ‡∏•‡∏¢ (‡πÄ‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏î‡πâ‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏≠‡∏á)\r\n  };\r\n\r\n  const handleRotateShip = (shipId) => {\r\n    setMyShips(ships => ships.map(s => {\r\n      if (s.id === shipId) {\r\n        const newOrientation = s.orientation === 'horizontal' ? 'vertical' : 'horizontal';\r\n        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏ö‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°\r\n        if (s.position) {\r\n            const validationResult = checkPlacement({ ...s, orientation: newOrientation }, s.position, ships);\r\n            if (!validationResult.isValid) {\r\n                return s; // ‡∏ñ‡πâ‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡∏ó‡∏±‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πâ‡∏ô‡∏Ç‡∏≠‡∏ö ‡πÉ‡∏´‡πâ‡∏Ñ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°\r\n            }\r\n        }\r\n        return { ...s, orientation: newOrientation };\r\n      }\r\n      return s;\r\n    }));\r\n  };\r\n\r\n  const [, dropPalette] = useDrop(() => ({\r\n    accept: ItemTypes.SHIP,\r\n    drop: (item) => { setMyShips(ships => ships.map(s => s.id === item.id ? { ...s, position: null } : s)) },\r\n  }));\r\n\r\n  // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ---\r\n\r\n  const validateFullBoard = (allShips) => {\r\n    const placedShips = allShips.filter(s => s.position);\r\n    return placedShips.length === 4;\r\n  };\r\n\r\n  useEffect(() => {\r\n    setIsPlacementValid(validateFullBoard(myShips));\r\n  }, [myShips]);\r\n\r\n  useEffect(() => {\r\n    if (gameState?.gameStatus === 'placing' && me?.ships.length === 0) {\r\n      setMyShips(initialShips);\r\n    }\r\n    if (gameState?.gameStatus === 'waiting') {\r\n      setMyShips(initialShips);\r\n    }\r\n  }, [gameState, me]);\r\n\r\n  const handleConfirmPlacement = () => {\r\n    // ... ‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ...\r\n  };\r\n  \r\n  if (!gameState || !me) return <div>Loading or connecting...</div>;\r\n\r\n  // --- ‡∏™‡πà‡∏ß‡∏ô Render ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° ---\r\n  if (gameState.gameStatus === 'placing') {\r\n    // ...\r\n  }\r\n  if (gameState.gameStatus === 'playing' || gameState.gameStatus === 'gameover') {\r\n    // ...\r\n  }\r\n  return <div>Unhandled game state...</div>;\r\n}\r\n\r\nexport default Game;"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAMA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}